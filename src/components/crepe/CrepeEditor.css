/**
 * Crepe ç¼–è¾‘å™¨æ ·å¼è¦†ç›–
 * é€‚é…é¡¹ç›®è®¾è®¡ç³»ç»Ÿå’Œæš—è‰²æ¨¡å¼
 * 
 * é‡è¦ï¼šæ­¤æ–‡ä»¶å®Œå…¨è¦†ç›– Crepe é»˜è®¤çš„ frame/frame-dark ä¸»é¢˜
 * æ‰€æœ‰é¢œè‰²éƒ½ä½¿ç”¨é¡¹ç›® CSS å˜é‡
 */

/* ===== Crepe é¢œè‰²å˜é‡æ˜ å°„åˆ°é¡¹ç›®é¢œè‰²ç³»ç»Ÿ ===== */
.crepe-editor-wrapper .milkdown {
  /* èƒŒæ™¯è‰² */
  --crepe-color-background: hsl(var(--background));
  --crepe-color-on-background: hsl(var(--foreground));
  
  /* è¡¨é¢è‰² - ç”¨äºä»£ç å—ã€LaTeX é¢„è§ˆç­‰ */
  --crepe-color-surface: hsl(var(--muted));
  --crepe-color-surface-low: hsl(var(--card));
  --crepe-color-on-surface: hsl(var(--foreground));
  /* åˆ—è¡¨æ ‡è®°ç­‰æ¬¡è¦å…ƒç´ ä½¿ç”¨è¾ƒæ·±çš„é¢œè‰²ï¼Œè€Œéæµ…ç° */
  --crepe-color-on-surface-variant: hsl(var(--foreground) / 0.7);
  
  /* è¾¹æ¡†å’Œè½®å»“ */
  --crepe-color-outline: hsl(var(--border));
  
  /* ä¸»é¢˜è‰² */
  --crepe-color-primary: hsl(var(--primary));
  --crepe-color-secondary: hsl(var(--secondary));
  --crepe-color-on-secondary: hsl(var(--secondary-foreground));
  
  /* åè‰² */
  --crepe-color-inverse: hsl(var(--accent));
  --crepe-color-on-inverse: hsl(var(--accent-foreground));
  
  /* ä»£ç å’Œé”™è¯¯ */
  --crepe-color-inline-code: hsl(var(--destructive));
  --crepe-color-error: hsl(var(--destructive));
  
  /* äº¤äº’çŠ¶æ€ */
  --crepe-color-hover: hsl(var(--accent));
  --crepe-color-selected: hsl(var(--accent));
  --crepe-color-inline-area: hsl(var(--muted));
  
  /* é˜´å½± */
  --crepe-shadow-1: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --crepe-shadow-2: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
}

/* ===== ç¼–è¾‘å™¨å®¹å™¨ ===== */
.crepe-editor-wrapper {
  width: 100%;
  min-height: 300px;
  position: relative;
  overflow: visible;
}

/* Crepe ç¼–è¾‘å™¨å†…éƒ¨å®¹å™¨ */
.crepe-editor-wrapper .crepe-editor-container {
  width: 100%;
  min-height: inherit;
}

.crepe-editor-wrapper[data-ready="false"] {
  opacity: 0.7;
}

/* ===== ç¼–è¾‘å™¨ä¸»ä½“ ===== */
.crepe-editor-wrapper .milkdown {
  outline: none;
  min-height: inherit;
  background: transparent !important;
  color: var(--foreground) !important;
  overflow: visible !important; /* ç¡®ä¿ block handle ä¸è¢«è£å‰ª */
  position: relative;
}

.crepe-editor-wrapper .editor {
  padding: 1rem 0;
  min-height: inherit;
  background: transparent !important;
}

/* ===== ProseMirror æ ¸å¿ƒæ ·å¼ ===== */
.crepe-editor-wrapper .ProseMirror {
  outline: none;
  min-height: inherit;
  background: transparent !important;
  color: var(--foreground) !important;
  caret-color: var(--foreground) !important;
}

.crepe-editor-wrapper .ProseMirror > * + * {
  margin-top: 0.75em;
}

/* ===== æ–‡æœ¬é€‰ä¸­æ ·å¼ - å…³é”®ä¿®å¤ ===== */
.crepe-editor-wrapper .ProseMirror ::selection {
  background: hsl(var(--primary) / 0.2) !important;
  color: inherit !important;
}

.crepe-editor-wrapper .ProseMirror::-moz-selection {
  background: hsl(var(--primary) / 0.2) !important;
  color: inherit !important;
}

/* Crepe/Milkdown ç‰¹å®šé€‰ä¸­æ ·å¼è¦†ç›– */
.crepe-editor-wrapper .ProseMirror-selectednode {
  outline: 2px solid hsl(var(--primary)) !important;
  outline-offset: 2px;
}

.crepe-editor-wrapper .selectedCell {
  background: hsl(var(--primary) / 0.1) !important;
}

/* é€‰ä¸­é«˜äº®èƒŒæ™¯ */
.crepe-editor-wrapper [data-selected],
.crepe-editor-wrapper .selected,
.crepe-editor-wrapper [class*="selected"] {
  background: hsl(var(--primary) / 0.15) !important;
}

/* ===== CodeMirror ä»£ç ç¼–è¾‘å™¨æ ·å¼ ===== */
.crepe-editor-wrapper .cm-editor {
  background: var(--muted) !important;
  border-radius: 0.5rem;
}

.crepe-editor-wrapper .cm-scroller {
  background: transparent !important;
}

.crepe-editor-wrapper .cm-content {
  color: var(--foreground) !important;
  caret-color: var(--foreground) !important;
}

.crepe-editor-wrapper .cm-gutters {
  background: var(--muted) !important;
  border-color: var(--border) !important;
  color: var(--muted-foreground) !important;
}

.crepe-editor-wrapper .cm-activeLineGutter {
  background: hsl(var(--primary) / 0.1) !important;
}

.crepe-editor-wrapper .cm-activeLine {
  background: hsl(var(--primary) / 0.05) !important;
}

.crepe-editor-wrapper .cm-selectionBackground,
.crepe-editor-wrapper .cm-editor .cm-selectionBackground {
  background: hsl(var(--primary) / 0.2) !important;
}

.crepe-editor-wrapper .cm-cursor {
  border-left-color: var(--foreground) !important;
}

.crepe-editor-wrapper .cm-matchingBracket {
  background: hsl(var(--primary) / 0.2) !important;
  outline: 1px solid hsl(var(--primary) / 0.5);
}

/* ===== ä»£ç å—å®¹å™¨æ ·å¼ ===== */
.crepe-editor-wrapper .milkdown .milkdown-code-block {
  background: hsl(var(--muted)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 0.5rem !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .tools {
  background: transparent !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .language-button {
  background: hsl(var(--accent)) !important;
  color: hsl(var(--accent-foreground)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .list-wrapper {
  background: hsl(var(--popover)) !important;
  border: 1px solid hsl(var(--border)) !important;
  overflow: hidden !important;
}

/* è¯­è¨€æœç´¢æ¡†æ ·å¼ä¿®å¤ - ç¼©å°å®½åº¦é˜²æ­¢æº¢å‡ºï¼Œç§»é™¤è¾¹æ¡† */
.crepe-editor-wrapper .milkdown .milkdown-code-block .search-box {
  width: calc(100% - 28px) !important;
  margin: 0 14px 8px !important;
  outline: none !important;
  border: none !important;
  background: transparent !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .search-box:has(input:focus) {
  outline: none !important;
}

/* æœç´¢è¾“å…¥æ¡†æ ·å¼ */
.crepe-editor-wrapper .milkdown .milkdown-code-block .search-box input {
  background: hsl(var(--muted)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 4px !important;
  padding: 6px 10px !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .search-box input:focus {
  border-color: hsl(var(--primary)) !important;
  outline: none !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .language-list-item:hover {
  background: hsl(var(--accent)) !important;
}

/* è¯­è¨€åˆ—è¡¨æ»šåŠ¨æ¡ - ä½¿ç”¨é¡¹ç›®è‡ªç ”ç»†æ»šåŠ¨æ¡ */
.crepe-editor-wrapper .milkdown .milkdown-code-block .list-wrapper .language-list,
.milkdown .milkdown-code-block .language-list {
  scrollbar-width: thin !important;
  scrollbar-color: hsl(var(--muted-foreground) / 0.35) transparent !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .list-wrapper .language-list::-webkit-scrollbar,
.milkdown .milkdown-code-block .language-list::-webkit-scrollbar {
  width: 4px !important;
  height: 4px !important;
  display: block !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .list-wrapper .language-list::-webkit-scrollbar-track,
.milkdown .milkdown-code-block .language-list::-webkit-scrollbar-track {
  background: transparent !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .list-wrapper .language-list::-webkit-scrollbar-thumb,
.milkdown .milkdown-code-block .language-list::-webkit-scrollbar-thumb {
  background: hsl(var(--muted-foreground) / 0.35) !important;
  border-radius: 4px !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .list-wrapper .language-list::-webkit-scrollbar-thumb:hover,
.milkdown .milkdown-code-block .language-list::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--primary) / 0.55) !important;
}

/* æš—è‰²æ¨¡å¼æ»šåŠ¨æ¡ */
.dark .crepe-editor-wrapper .milkdown .milkdown-code-block .language-list,
.dark .milkdown .milkdown-code-block .language-list {
  scrollbar-color: hsl(var(--muted-foreground) / 0.4) transparent !important;
}

.dark .crepe-editor-wrapper .milkdown .milkdown-code-block .language-list::-webkit-scrollbar-thumb,
.dark .milkdown .milkdown-code-block .language-list::-webkit-scrollbar-thumb {
  background: hsl(var(--muted-foreground) / 0.4) !important;
}

/* ä»£ç å—å·¥å…·æ æŒ‰é’®å§‹ç»ˆæ˜¾ç¤ºï¼ˆè¦†ç›–é»˜è®¤çš„æ‚¬æµ®æ˜¾ç¤ºï¼‰ */
.crepe-editor-wrapper .milkdown .milkdown-code-block .tools .tools-button-group button {
  opacity: 1 !important;
}

/* ===== LaTeX / æ•°å­¦å…¬å¼é¢„è§ˆæ ·å¼ ===== */
.crepe-editor-wrapper .milkdown .milkdown-code-block .preview-panel {
  background: hsl(var(--muted)) !important;
  color: hsl(var(--foreground)) !important;
  height: auto !important;
  min-height: auto !important;
  flex-grow: 0 !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .preview-panel .preview {
  background: hsl(var(--card)) !important;
  color: hsl(var(--card-foreground)) !important;
  padding: 1rem !important;
  border-radius: 0.375rem !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .preview-panel .preview-label {
  color: hsl(var(--muted-foreground)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-code-block .preview-panel .preview-divider {
  background: hsl(var(--border)) !important;
}

/* LaTeX å†…è”ç¼–è¾‘å™¨ */
.crepe-editor-wrapper .milkdown .milkdown-latex-inline-edit {
  background: hsl(var(--popover)) !important;
  border: 1px solid hsl(var(--border)) !important;
  box-shadow: 0 4px 12px rgb(0 0 0 / 0.15) !important;
}

/* æ ‡é¢˜æ ·å¼ */
.crepe-editor-wrapper h1 {
  font-size: 2em;
  font-weight: 700;
  line-height: 1.2;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
}

.crepe-editor-wrapper h2 {
  font-size: 1.5em;
  font-weight: 600;
  line-height: 1.3;
  margin-top: 1.25em;
  margin-bottom: 0.5em;
}

.crepe-editor-wrapper h3 {
  font-size: 1.25em;
  font-weight: 600;
  line-height: 1.4;
  margin-top: 1em;
  margin-bottom: 0.5em;
}

/* ä»£ç å—æ ·å¼ */
.crepe-editor-wrapper pre {
  background: var(--muted, hsl(210 40% 96.1%));
  border-radius: 0.5rem;
  padding: 1rem;
  overflow-x: auto;
}

.crepe-editor-wrapper code {
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
  font-size: 0.875em;
}

.crepe-editor-wrapper :not(pre) > code {
  background: var(--muted, hsl(210 40% 96.1%));
  padding: 0.2em 0.4em;
  border-radius: 0.25rem;
}

/* å¼•ç”¨å— */
.crepe-editor-wrapper blockquote {
  border-left: 4px solid hsl(var(--primary));
  padding-left: 1rem;
  margin-left: 0;
  font-style: italic;
  /* å¼•ç”¨æ–‡å­—ä½¿ç”¨ç¨æµ…çš„å‰æ™¯è‰²ï¼Œä½†ä¸èƒ½å¤ªæµ… */
  color: hsl(var(--foreground) / 0.75);
}

/* é“¾æ¥ */
.crepe-editor-wrapper a {
  color: hsl(var(--primary));
  text-decoration: underline;
  text-underline-offset: 3px;
  cursor: pointer;
  transition: color 0.2s, opacity 0.2s;
}

.crepe-editor-wrapper a:hover {
  /* æ‚¬åœæ—¶ä½¿ç”¨ primary çš„æ›´æ·±/æ›´äº®ç‰ˆæœ¬ï¼Œè€Œé primary-foreground */
  color: hsl(var(--primary));
  opacity: 0.8;
}

/* åˆ—è¡¨ */
.crepe-editor-wrapper ul,
.crepe-editor-wrapper ol {
  padding-left: 1.5rem;
  /* åˆ—è¡¨é¢œè‰²ä¼šå½±å“ marker çš„é¢œè‰² */
  color: hsl(var(--foreground));
}

.crepe-editor-wrapper ul {
  list-style-type: disc;
}

.crepe-editor-wrapper ol {
  list-style-type: decimal;
}

.crepe-editor-wrapper li {
  margin-top: 0.25em;
  /* åˆ—è¡¨é¡¹ç»§æ‰¿æ­£ç¡®çš„æ–‡å­—é¢œè‰² */
  color: hsl(var(--foreground));
}

/* å¼ºåˆ¶æ— åºåˆ—è¡¨é¡¹ç›®ç¬¦å·é¢œè‰² */
.crepe-editor-wrapper ul > li::marker {
  color: hsl(var(--foreground) / 0.6) !important;
}

.crepe-editor-wrapper ol > li::marker {
  color: hsl(var(--foreground) / 0.7) !important;
}

/* ä»»åŠ¡åˆ—è¡¨ */
.crepe-editor-wrapper .task-list-item {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  list-style: none;
}

.crepe-editor-wrapper .task-list-item input[type="checkbox"] {
  margin-top: 0.25em;
  cursor: pointer;
}

/* åˆ†éš”çº¿ */
.crepe-editor-wrapper hr {
  border: none;
  border-top: 1px solid var(--border, hsl(214.3 31.8% 91.4%));
  margin: 2rem 0;
}

/* è¡¨æ ¼ */
.crepe-editor-wrapper table {
  border-collapse: collapse;
  width: 100%;
  margin: 1rem 0;
}

.crepe-editor-wrapper th,
.crepe-editor-wrapper td {
  border: 1px solid var(--border, hsl(214.3 31.8% 91.4%));
  padding: 0.5rem 0.75rem;
  text-align: left;
}

.crepe-editor-wrapper th {
  background: var(--muted, hsl(210 40% 96.1%));
  font-weight: 600;
}

/* å›¾ç‰‡ */
.crepe-editor-wrapper img {
  max-width: 100%;
  height: auto;
  border-radius: 0.5rem;
}

/* æ•°å­¦å…¬å¼ */
.crepe-editor-wrapper .katex-display {
  margin: 1rem 0;
  overflow-x: auto;
}

/* å ä½ç¬¦ */
.crepe-editor-wrapper .placeholder {
  color: var(--muted-foreground, hsl(215.4 16.3% 46.9%));
  pointer-events: none;
}

/* ===== æ–œæ èœå•ï¼ˆSlash Menuï¼‰ ===== */
/* åªè¦†ç›–è§†è§‰æ ·å¼ï¼Œä¿ç•™ Crepe åŸæœ‰å¸ƒå±€å’Œäº¤äº’é€»è¾‘ */

/* å¤–å±‚å®¹å™¨ - åªä¿®æ”¹è§†è§‰æ ·å¼ */
.crepe-editor-wrapper .milkdown .milkdown-slash-menu {
  background: hsl(var(--popover)) !important;
  color: hsl(var(--popover-foreground)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 12px rgb(0 0 0 / 0.12) !important;
  overflow-x: hidden !important;
}

/* Tab æ ‡ç­¾æ  - ç´§å‡‘æ ·å¼ */
.crepe-editor-wrapper .milkdown .milkdown-slash-menu .tab-group {
  padding: 6px 8px 0 !important;
  border-bottom-color: hsl(var(--border)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .tab-group ul {
  padding: 4px 6px !important;
  gap: 4px !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .tab-group ul li {
  padding: 4px 10px !important;
  font-size: 12px !important;
  font-weight: 500 !important;
  line-height: 1.4 !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .tab-group ul li:hover {
  background: hsl(var(--accent)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .tab-group ul li.selected {
  background: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
}

/* èœå•æ»šåŠ¨åŒºåŸŸ - ä½¿ç”¨é¡¹ç›®è‡ªç ”æ»šåŠ¨æ¡ï¼ˆä¸ CustomScrollArea åŒæºè§†è§‰ï¼‰ */
.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups {
  padding: 4px 8px 8px !important;
  max-height: 280px !important;
  overflow-x: hidden !important;
  overflow-y: auto !important;
  overscroll-behavior: contain;
  scroll-behavior: smooth;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups.ds-slash-scroll-viewport {
  padding-right: 12px !important;
  scrollbar-width: none !important;
  -ms-overflow-style: none !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups.ds-slash-scroll-viewport::-webkit-scrollbar {
  width: 0 !important;
  height: 0 !important;
  display: none !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-track {
  position: absolute;
  right: 6px;
  width: 6px;
  border-radius: 9999px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s ease;
  z-index: 1;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-track[data-enabled='true'][data-visible='true'] {
  opacity: 1;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-thumb {
  position: absolute;
  left: 0;
  width: 100%;
  min-height: 36px;
  border-radius: 9999px;
  pointer-events: auto;
  background: hsl(var(--muted-foreground) / 0.35);
  box-shadow: inset 0 0 0 1px hsl(var(--background) / 0.25);
  transition: background-color 0.15s ease;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-track:hover .ds-slash-scroll-thumb {
  background: hsl(var(--muted-foreground) / 0.55);
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-thumb:active {
  background: hsl(var(--muted-foreground) / 0.7);
}

.dark .crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-thumb {
  background: hsl(var(--muted-foreground) / 0.4);
}

.dark .crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-track:hover .ds-slash-scroll-thumb {
  background: hsl(var(--muted-foreground) / 0.6);
}

.dark .crepe-editor-wrapper .milkdown .milkdown-slash-menu .ds-slash-scroll-thumb:active {
  background: hsl(var(--muted-foreground) / 0.75);
}

/* åˆ†ç»„æ ‡é¢˜ - ç´§å‡‘æ ·å¼ */
.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group h6 {
  font-size: 10px !important;
  font-weight: 600 !important;
  line-height: 1.2 !important;
  padding: 6px 8px 4px !important;
  color: hsl(var(--muted-foreground)) !important;
}

/* åˆ†ç»„åˆ†éš”çº¿ */
.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group + .menu-group::before {
  background: hsl(var(--border)) !important;
}

/* èœå•é¡¹ - ç´§å‡‘æ ·å¼ */
.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group li {
  min-width: 140px !important;
  padding: 6px 8px !important;
  gap: 10px !important;
  border-radius: 4px !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group li > span {
  font-size: 13px !important;
  font-weight: 400 !important;
  line-height: 1.3 !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group li svg {
  width: 18px !important;
  height: 18px !important;
  color: hsl(var(--muted-foreground)) !important;
  fill: hsl(var(--muted-foreground)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group li:hover,
.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group li.hover {
  background: hsl(var(--accent)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-slash-menu .menu-groups .menu-group li.active {
  background: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
}

/* ===== æ°”æ³¡å·¥å…·æ ï¼ˆBubble Toolbarï¼‰ ===== */

/* è¦†ç›– Crepe å·¥å…·æ çš„ CSS å˜é‡ - ç§»é™¤æŒ‰é’®è¾¹æ¡† */
.crepe-editor-wrapper .milkdown .milkdown-toolbar {
  --crepe-color-outline: transparent !important;
  --crepe-color-surface-low: transparent !important;
  --crepe-color-line: transparent !important;
  --crepe-color-border: transparent !important;
}

/* Milkdown å·¥å…·æ å®¹å™¨ */
.crepe-editor-wrapper .milkdown .milkdown-toolbar {
  z-index: 50 !important;
  background: hsl(var(--background)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 12px rgb(0 0 0 / 0.15) !important;
  contain: layout style;
  will-change: transform;
  pointer-events: auto;
  padding: 4px 6px !important;
  gap: 4px !important;
}

/* å·¥å…·æ æŒ‰é’® - button.toolbar-item */
.crepe-editor-wrapper .milkdown .milkdown-toolbar button.toolbar-item,
.crepe-editor-wrapper .milkdown .milkdown-toolbar .toolbar-item {
  all: unset !important;
  cursor: pointer !important;
  padding: 6px !important;
  border-radius: 4px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  transition: background 0.15s !important;
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
}

/* å·¥å…·æ å†…æ‰€æœ‰å­å…ƒç´ éƒ½é‡ç½®è¾¹æ¡† */
.crepe-editor-wrapper .milkdown .milkdown-toolbar button.toolbar-item *,
.crepe-editor-wrapper .milkdown .milkdown-toolbar .toolbar-item *,
.crepe-editor-wrapper .milkdown .milkdown-toolbar button,
.crepe-editor-wrapper .milkdown .milkdown-toolbar button *,
.crepe-editor-wrapper .milkdown .milkdown-toolbar [class*="group"],
.crepe-editor-wrapper .milkdown .milkdown-toolbar [class*="group"] * {
  all: unset !important;
  border: none !important;
  background: transparent !important;
  box-shadow: none !important;
}

.crepe-editor-wrapper .milkdown .milkdown-toolbar .toolbar-item svg {
  color: hsl(var(--foreground) / 0.65) !important;
  fill: hsl(var(--foreground) / 0.65) !important;
  width: 18px !important;
  height: 18px !important;
  display: block !important;
}

.crepe-editor-wrapper .milkdown .milkdown-toolbar .toolbar-item:hover {
  background: hsl(var(--accent)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-toolbar .toolbar-item:hover svg {
  color: hsl(var(--foreground)) !important;
  fill: hsl(var(--foreground)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-toolbar .toolbar-item.active svg {
  color: hsl(var(--primary)) !important;
  fill: hsl(var(--primary)) !important;
}

/* å·¥å…·æ åˆ†éš”çº¿ */
.crepe-editor-wrapper .milkdown .milkdown-toolbar .divider {
  all: unset !important;
  display: block !important;
  background: hsl(var(--border)) !important;
  margin: 0 8px !important;
  width: 1px !important;
  height: 16px !important;
}

/* å¼ºåˆ¶ç§»é™¤ group å®¹å™¨è¾¹æ¡† */
.crepe-editor-wrapper .milkdown .milkdown-toolbar .group {
  all: unset !important;
  display: flex !important;
  gap: 4px !important;
}

/* é€šç”¨å·¥å…·æ æ ·å¼ï¼ˆå…¼å®¹å…¶ä»–å·¥å…·æ ï¼‰ */
.crepe-editor-wrapper [data-milkdown-toolbar],
.crepe-editor-wrapper [class*="toolbar"]:not(.milkdown-toolbar):not(.notes-editor-toolbar) {
  z-index: 50;
  background: hsl(var(--background)) !important;
  color: hsl(var(--foreground)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 0.5rem;
  box-shadow: 0 4px 12px rgb(0 0 0 / 0.15);
  padding: 0.25rem;
  display: flex;
  gap: 0.125rem;
}

/* é€šç”¨å·¥å…·æ æŒ‰é’® */
.crepe-editor-wrapper [data-milkdown-toolbar] button,
.crepe-editor-wrapper [class*="toolbar"]:not(.notes-editor-toolbar) button {
  background: transparent !important;
  color: hsl(var(--foreground) / 0.7) !important;
  border: none !important;
  border-radius: 0.25rem;
  padding: 0.375rem;
  transition: background 0.15s, color 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.crepe-editor-wrapper [data-milkdown-toolbar] button:hover,
.crepe-editor-wrapper [class*="toolbar"]:not(.notes-editor-toolbar) button:hover {
  background: hsl(var(--accent)) !important;
  color: hsl(var(--foreground)) !important;
}

.crepe-editor-wrapper [data-milkdown-toolbar] button[data-active="true"],
.crepe-editor-wrapper [data-milkdown-toolbar] button.active {
  background: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
}

/* é€šç”¨å·¥å…·æ å›¾æ ‡ */
.crepe-editor-wrapper [data-milkdown-toolbar] svg {
  color: inherit !important;
  fill: currentColor !important;
}

/* é€šç”¨å·¥å…·æ åˆ†éš”çº¿ */
.crepe-editor-wrapper [data-milkdown-toolbar] [class*="divider"],
.crepe-editor-wrapper [data-milkdown-toolbar] hr {
  background: hsl(var(--border)) !important;
  width: 1px;
  height: 1.25rem;
  margin: 0 0.25rem;
}

/* ===== æ‹–æ‹½å¥æŸ„ï¼ˆBlock Handleï¼‰ ===== */
/* ä¿ç•™ Crepe åŸæœ‰çš„ data-show æ˜¾ç¤ºé€»è¾‘ï¼Œåªè¦†ç›–è§†è§‰æ ·å¼ */

.crepe-editor-wrapper .milkdown .milkdown-block-handle {
  color: hsl(var(--foreground)) !important;
  transition: opacity 0.2s, color 0.15s;
  display: flex !important;
  align-items: center;
  gap: 4px !important;
  cursor: grab !important;
  user-select: none !important;
  background: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 0 !important;
  box-shadow: none !important;
}

.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle:active {
  cursor: grabbing !important;
}

/* ğŸ”§ å…³é”®ï¼šblock handle æ‹–æ‹½æŒ‰é’®éœ€è¦ touch-action: none æ‰èƒ½ä½¿ pointer capture æ­£å¸¸å·¥ä½œ */
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:nth-child(2) {
  touch-action: none;
  cursor: grab;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:nth-child(2):active {
  cursor: grabbing;
}

/* æ‹–æ‹½æ—¶çš„è§†è§‰åé¦ˆ */
.crepe-editor-wrapper[data-dragging="true"] {
  cursor: grabbing !important;
}

.crepe-editor-wrapper[data-dragging="true"] .milkdown {
  cursor: grabbing !important;
}

.crepe-editor-wrapper[data-dragging="true"] .ProseMirror {
  cursor: grabbing !important;
  /* ç¦ç”¨æ–‡æœ¬é€‰æ‹© */
  user-select: none;
}

/* ğŸ”§ æ‹–æ‹½æ—¶éšè—æµ®åŠ¨å·¥å…·æ ï¼Œé¿å…å¹²æ‰° */
.crepe-editor-wrapper[data-dragging="true"] .milkdown-block-handle,
.crepe-editor-wrapper[data-dragging="true"] .milkdown-toolbar,
.crepe-editor-wrapper[data-dragging="true"] .milkdown-slash-menu,
.crepe-editor-wrapper[data-dragging="true"] .milkdown-link-tooltip,
.crepe-editor-wrapper[data-dragging="true"] .milkdown-table-tooltip {
  display: none !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* æ‹–æ‹½é¢„è§ˆå…‹éš†æ ·å¼ï¼ˆä¿æŒåŸå§‹å—æ ·å¼ï¼‰ */
.crepe-drag-preview-clone {
  /* åŸºç¡€æ ·å¼ç”± JS åŠ¨æ€è®¾ç½® */
  /* è¿™é‡Œæ·»åŠ ä¸€äº›å¢å¼ºæ ·å¼ */
  transition: none !important;
  animation: none !important;
}

.crepe-drag-preview-clone * {
  transition: none !important;
  animation: none !important;
}

/* æš—è‰²æ¨¡å¼ä¸‹çš„å…‹éš†é¢„è§ˆ */
.dark .crepe-drag-preview-clone {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4) !important;
}

/* å…¼å®¹æ—§çš„ data-dragging åœ¨ .milkdown ä¸Šçš„æƒ…å†µ */
.crepe-editor-wrapper .milkdown[data-dragging="true"] {
  cursor: grabbing !important;
}

.crepe-editor-wrapper .milkdown[data-dragging="true"] .ProseMirror {
  cursor: grabbing !important;
}

/* ç¡®ä¿ç¼–è¾‘å™¨å¯ä»¥æ¥æ”¶ drop äº‹ä»¶ */
.crepe-editor-wrapper .milkdown .ProseMirror {
  min-height: 100px;
}


.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item {
  border-radius: 6px !important;
  width: 26px !important;
  height: 26px !important;
  padding: 4px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  cursor: pointer !important;
  background: transparent;
  transition: background 0.15s ease, color 0.15s ease;
}

/* å¼ºåˆ¶è¦†ç›– Crepe å†…éƒ¨çš„å›¾æ ‡é¢œè‰²å˜é‡ */
.crepe-editor-wrapper .milkdown .milkdown-block-handle {
  --crepe-color-solid: hsl(var(--foreground)) !important;
  --crepe-color-icon: hsl(var(--foreground)) !important;
  --icon-color: hsl(var(--foreground)) !important;
  color: hsl(var(--foreground)) !important;
}

/* Block handle å›¾æ ‡ - æå¼ºè¦†ç›– */
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item * {
  color: hsl(var(--foreground) / 0.7) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg {
  width: 18px !important;
  height: 18px !important;
  fill: hsl(var(--foreground) / 0.7) !important;
  color: hsl(var(--foreground) / 0.7) !important;
  stroke: hsl(var(--foreground) / 0.7) !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* å¦‚æœå›¾æ ‡ä½¿ç”¨ mask-image å®ç°ï¼ˆé€šè¿‡ span/i/div å­å…ƒç´ ï¼‰ */
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item > span,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item > i,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item > div {
  color: hsl(var(--foreground) / 0.7) !important;
}

/* å¦‚æœå­å…ƒç´ ä½¿ç”¨ mask-imageï¼Œéœ€è¦è®¾ç½® background-color ä½œä¸ºé¢œè‰²æº */
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item > *[style*="mask"],
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item > *[style*="-webkit-mask"] {
  background-color: hsl(var(--foreground) / 0.7) !important;
}

/* è¦†ç›–å¯èƒ½çš„å†…è”æ ·å¼å’Œä»»ä½•å­å…ƒç´  */
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg *,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg[style],
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg[style] * {
  fill: hsl(var(--foreground) / 0.7) !important;
  color: hsl(var(--foreground) / 0.7) !important;
  stroke: hsl(var(--foreground) / 0.7) !important;
  opacity: 1 !important;
}

/* ç¡®ä¿ path å…ƒç´ ä¹Ÿæœ‰æ­£ç¡®çš„å¡«å……è‰²å’Œæè¾¹è‰² */
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg path,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg circle,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg line,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg rect {
  fill: hsl(var(--foreground) / 0.75) !important;
  stroke: hsl(var(--foreground) / 0.75) !important;
}

/* æš—è‰²æ¨¡å¼ä¸‹ä½¿ç”¨æ›´äº®çš„é¢œè‰² */
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle {
  --crepe-color-solid: hsl(var(--foreground)) !important;
  --crepe-color-icon: hsl(var(--foreground)) !important;
  --icon-color: hsl(var(--foreground)) !important;
}

.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg,
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg path,
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg circle,
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg line,
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg rect,
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg[style],
.dark .crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item svg[style] * {
  fill: hsl(var(--foreground)) !important;
  color: hsl(var(--foreground)) !important;
  stroke: hsl(var(--foreground)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:hover {
  background: var(--accent) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:hover svg,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:hover svg path,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:hover svg circle,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:hover svg line,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item:hover svg rect {
  fill: hsl(var(--foreground)) !important;
  color: hsl(var(--foreground)) !important;
  stroke: hsl(var(--foreground)) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item.active {
  background: var(--primary) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item.active svg,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item.active svg path,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item.active svg circle,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item.active svg line,
.crepe-editor-wrapper .milkdown .milkdown-block-handle .operation-item.active svg rect {
  fill: var(--primary-foreground) !important;
  color: var(--primary-foreground) !important;
  stroke: var(--primary-foreground) !important;
}

/* ===== é“¾æ¥æç¤ºæ¡† ===== */
.crepe-editor-wrapper [class*="link-tooltip"],
.crepe-editor-wrapper [data-milkdown-tooltip] {
  background: var(--popover) !important;
  color: var(--popover-foreground) !important;
  border: 1px solid var(--border) !important;
  border-radius: 0.5rem;
  box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  padding: 0.5rem;
}

.crepe-editor-wrapper [class*="link-tooltip"] input,
.crepe-editor-wrapper [data-milkdown-tooltip] input {
  background: var(--background) !important;
  color: var(--foreground) !important;
  border: 1px solid var(--border) !important;
  border-radius: 0.25rem;
  padding: 0.25rem 0.5rem;
}

/* ===== å›¾ç‰‡å—æ ·å¼ ===== */
.crepe-editor-wrapper [class*="image-block"],
.crepe-editor-wrapper [data-type="image"] {
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  overflow: hidden;
}

/* é€‰ä¸­æ—¶é«˜äº®è¾¹æ¡† */
.crepe-editor-wrapper [class*="image-block"].selected,
.crepe-editor-wrapper [data-type="image"].selected {
  border-color: var(--primary);
}

/* ===== è¿‡æ¸¡åŠ¨ç”» ===== */
.crepe-editor-wrapper [data-milkdown-menu],
.crepe-editor-wrapper [data-milkdown-toolbar],
.crepe-editor-wrapper [class*="toolbar"],
.crepe-editor-wrapper [class*="slash"] {
  animation: crepe-fade-in 0.15s ease-out;
}

@keyframes crepe-fade-in {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ===== Mermaid å›¾è¡¨é¢„è§ˆ ===== */
.crepe-editor-wrapper .mermaid-preview {
  margin-top: 0.5rem;
  padding: 1rem;
  background: var(--muted);
  border-radius: 0.5rem;
  border: 1px solid var(--border);
  overflow-x: auto;
}

.crepe-editor-wrapper .mermaid-preview svg {
  max-width: 100%;
  height: auto;
}

.crepe-editor-wrapper .mermaid-preview.mermaid-error {
  color: var(--destructive);
  font-size: 0.875em;
}

/* ===== Crepe å†…éƒ¨ frame ä¸»é¢˜å½»åº•è¦†ç›– ===== */
/* è¦†ç›– Crepe frame/frame-dark çš„æ‰€æœ‰ç¡¬ç¼–ç é¢œè‰² */

/* æ ¹å…ƒç´ å˜é‡è¦†ç›– */
.crepe-editor-wrapper,
.crepe-editor-wrapper .milkdown,
.crepe-editor-wrapper .editor {
  --crepe-color-background: var(--background) !important;
  --crepe-color-surface: var(--card) !important;
  --crepe-color-overlay: var(--popover) !important;
  --crepe-color-primary: hsl(var(--primary)) !important;
  --crepe-color-secondary: var(--secondary) !important;
  --crepe-color-solid: var(--foreground) !important;
  --crepe-color-line: var(--border) !important;
  --crepe-color-border: var(--border) !important;
  /* åˆ—è¡¨æ ‡è®°å’Œæ¬¡è¦å…ƒç´ ä½¿ç”¨è¾ƒæ·±é¢œè‰² */
  --crepe-color-inline: hsl(var(--foreground) / 0.7) !important;
  --crepe-color-on-surface-variant: hsl(var(--foreground) / 0.7) !important;
  --crepe-color-on-primary: var(--primary-foreground) !important;
  --crepe-color-shadow: 0 0 0 transparent !important;
}

/* å½»åº•è¦†ç›–æ‰€æœ‰å¯èƒ½çš„æš—è‰²èƒŒæ™¯ */
.crepe-editor-wrapper [style*="background"],
.crepe-editor-wrapper [style*="background-color"] {
  background: inherit !important;
}

/* Crepe ç‰¹å®šç±»åè¦†ç›– */
.crepe-editor-wrapper .crepe,
.crepe-editor-wrapper [class*="crepe-"] {
  background: transparent !important;
  color: var(--foreground) !important;
}

/* è¡¨æ ¼å•å…ƒæ ¼é€‰ä¸­ */
.crepe-editor-wrapper .tableWrapper .selectedCell,
.crepe-editor-wrapper td.selectedCell,
.crepe-editor-wrapper th.selectedCell {
  background: hsl(var(--primary) / 0.15) !important;
  border-color: hsl(var(--primary)) !important;
}

/* åˆ—è¡¨æ ‡è®°é¢œè‰² - äº®è‰²æ¨¡å¼ä¸‹ä½¿ç”¨æ·±è‰² */
.crepe-editor-wrapper ul > li::marker,
.crepe-editor-wrapper ol > li::marker {
  color: hsl(var(--foreground) / 0.7) !important;
}

/* ===== Milkdown åˆ—è¡¨æ ·å¼å…¨é¢è¦†ç›– ===== */

/* Milkdown ä½¿ç”¨ .label-wrapper æ¥æ¸²æŸ“åˆ—è¡¨æ ‡è®°ï¼Œéœ€è¦ç›´æ¥è¦†ç›– */
.crepe-editor-wrapper .milkdown .milkdown-list-item-block li .label-wrapper {
  color: hsl(var(--foreground) / 0.6) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-list-item-block li .label-wrapper svg {
  fill: hsl(var(--foreground) / 0.6) !important;
}

.crepe-editor-wrapper .milkdown .milkdown-list-item-block li .label-wrapper .label {
  color: hsl(var(--foreground) / 0.6) !important;
}

/* å¼ºåˆ¶æ‰€æœ‰åˆ—è¡¨ä½¿ç”¨æ·±è‰² - é€šè¿‡åœ¨ ul/ol ä¸Šè®¾ç½® colorï¼Œmarker ä¼šç»§æ‰¿ */
.crepe-editor-wrapper ul,
.crepe-editor-wrapper ol,
.crepe-editor-wrapper .milkdown ul,
.crepe-editor-wrapper .milkdown ol,
.crepe-editor-wrapper .ProseMirror ul,
.crepe-editor-wrapper .ProseMirror ol,
.crepe-editor-wrapper .editor ul,
.crepe-editor-wrapper .editor ol {
  color: hsl(var(--foreground) / 0.6) !important;
}

/* åˆ—è¡¨é¡¹ - è®¾ç½®é¢œè‰²è®© marker ç»§æ‰¿ */
.crepe-editor-wrapper li,
.crepe-editor-wrapper .milkdown li,
.crepe-editor-wrapper .ProseMirror li,
.crepe-editor-wrapper .editor li {
  color: hsl(var(--foreground) / 0.6) !important;
}

/* åˆ—è¡¨é¡¹æ ‡è®° - ::marker ä¼ªå…ƒç´  - æœ€é«˜ä¼˜å…ˆçº§ */
.crepe-editor-wrapper li::marker,
.crepe-editor-wrapper ul li::marker,
.crepe-editor-wrapper ol li::marker,
.crepe-editor-wrapper .milkdown li::marker,
.crepe-editor-wrapper .milkdown ul li::marker,
.crepe-editor-wrapper .milkdown ol li::marker,
.crepe-editor-wrapper .ProseMirror li::marker,
.crepe-editor-wrapper .ProseMirror ul li::marker,
.crepe-editor-wrapper .ProseMirror ol li::marker {
  color: hsl(var(--foreground) / 0.6) !important;
}

/* åˆ—è¡¨é¡¹å†…çš„æ–‡å­—å†…å®¹æ¢å¤ä¸ºæ­£å¸¸é¢œè‰² */
.crepe-editor-wrapper li > *,
.crepe-editor-wrapper li > p,
.crepe-editor-wrapper li > div,
.crepe-editor-wrapper li > span,
.crepe-editor-wrapper .milkdown li > *,
.crepe-editor-wrapper .milkdown li > p,
.crepe-editor-wrapper .milkdown li > div,
.crepe-editor-wrapper .milkdown li > span,
.crepe-editor-wrapper .ProseMirror li > *,
.crepe-editor-wrapper .ProseMirror li > p,
.crepe-editor-wrapper .ProseMirror li > div,
.crepe-editor-wrapper .ProseMirror li > span {
  color: hsl(var(--foreground)) !important;
}


/* ä»»åŠ¡åˆ—è¡¨å¤é€‰æ¡† */
.crepe-editor-wrapper input[type="checkbox"] {
  accent-color: hsl(var(--primary));
}

/* ä»£ç å—è¯­è¨€æ ‡ç­¾ */
.crepe-editor-wrapper [class*="code-block"] [class*="language"],
.crepe-editor-wrapper pre [class*="language-label"] {
  background: var(--muted) !important;
  color: var(--muted-foreground) !important;
  border-color: var(--border) !important;
}

/* ===== é¡¶éƒ¨å·¥å…·æ æ ·å¼ ===== */
.notes-editor-toolbar {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.25rem;
  padding: 0.5rem 0;
  margin-bottom: 0;
  /* è¾¹æ¡†å·²ç”± .notes-editor-header-section æä¾›ï¼Œæ­¤å¤„ç§»é™¤ */
}

.notes-editor-toolbar button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2rem;
  height: 2rem;
  border: none;
  border-radius: 0.375rem;
  background: transparent;
  color: var(--muted-foreground);
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
}

.notes-editor-toolbar button:hover {
  background: var(--accent);
  color: var(--accent-foreground);
}

.notes-editor-toolbar button.active,
.notes-editor-toolbar button[data-active="true"] {
  background: var(--primary);
  color: var(--primary-foreground);
}

.notes-editor-toolbar button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.notes-editor-toolbar .divider {
  width: 1px;
  height: 1.5rem;
  background: var(--border);
  margin: 0 0.25rem;
}

/* ç§»åŠ¨ç«¯å·¥å…·æ æ ·å¼ä¼˜åŒ– - ä¸¤è¡Œå¸ƒå±€ */
@media (max-width: 640px) {
  .notes-editor-toolbar {
    gap: 0.25rem;
    padding: 0.375rem 0;
    flex-wrap: wrap;
    justify-content: flex-start;
  }

  .notes-editor-toolbar button {
    width: 1.75rem;
    height: 1.75rem;
  }

  .notes-editor-toolbar button svg {
    width: 0.875rem;
    height: 0.875rem;
  }

  .notes-editor-toolbar .divider {
    height: 1.25rem;
    margin: 0 0.125rem;
  }
}

/* ============================================================================
   æ‰“å°æ ·å¼ - Print Styles for Crepe Editor
   ============================================================================ */
@media print {
  /* ç¼–è¾‘å™¨å®¹å™¨ - æ‰“å°é€‚é… */
  .crepe-editor-wrapper {
    position: static !important;
    overflow: visible !important;
    width: 100% !important;
    max-width: none !important;
    height: auto !important;
    min-height: auto !important;
    padding: 0 !important;
    margin: 0 !important;
    background: white !important;
  }
  
  /* Milkdown ç¼–è¾‘å™¨ä¸»ä½“ */
  .crepe-editor-wrapper .milkdown,
  .crepe-editor-wrapper .editor,
  .crepe-editor-wrapper .ProseMirror {
    position: static !important;
    overflow: visible !important;
    background: white !important;
    color: black !important;
    padding: 0 !important;
    margin: 0 !important;
    min-height: auto !important;
    caret-color: transparent !important;
  }
  
  /* éšè—ç¼–è¾‘å™¨ UI å…ƒç´  */
  .crepe-editor-wrapper .milkdown-toolbar,
  .crepe-editor-wrapper .milkdown-block-handle,
  .crepe-editor-wrapper .milkdown-slash-menu,
  .crepe-editor-wrapper .milkdown-link-tooltip,
  .crepe-editor-wrapper .notes-editor-toolbar,
  .crepe-editor-wrapper [data-milkdown-toolbar],
  .crepe-editor-wrapper [data-milkdown-menu] {
    display: none !important;
    visibility: hidden !important;
  }
  
  /* æ–‡æœ¬æ ·å¼ - é»‘è‰²æ–‡å­— */
  .crepe-editor-wrapper h1,
  .crepe-editor-wrapper h2,
  .crepe-editor-wrapper h3,
  .crepe-editor-wrapper h4,
  .crepe-editor-wrapper h5,
  .crepe-editor-wrapper h6 {
    color: black !important;
    page-break-after: avoid;
    page-break-inside: avoid;
  }
  
  .crepe-editor-wrapper p,
  .crepe-editor-wrapper span,
  .crepe-editor-wrapper div,
  .crepe-editor-wrapper li,
  .crepe-editor-wrapper ul,
  .crepe-editor-wrapper ol {
    color: black !important;
  }
  
  /* åˆ—è¡¨æ ‡è®° */
  .crepe-editor-wrapper li::marker {
    color: black !important;
  }
  
  /* é“¾æ¥ */
  .crepe-editor-wrapper a {
    color: black !important;
    text-decoration: underline !important;
  }
  
  /* å¼•ç”¨å— */
  .crepe-editor-wrapper blockquote {
    border-left-color: #333 !important;
    color: #333 !important;
    background: transparent !important;
  }
  
  /* ä»£ç å— */
  .crepe-editor-wrapper pre,
  .crepe-editor-wrapper .milkdown-code-block {
    background: #f5f5f5 !important;
    border: 1px solid #ddd !important;
    color: black !important;
    page-break-inside: avoid;
  }
  
  .crepe-editor-wrapper code {
    background: #f5f5f5 !important;
    border: 1px solid #ddd !important;
    color: black !important;
  }
  
  /* CodeMirror ä»£ç ç¼–è¾‘å™¨ */
  .crepe-editor-wrapper .cm-editor,
  .crepe-editor-wrapper .cm-scroller,
  .crepe-editor-wrapper .cm-content,
  .crepe-editor-wrapper .cm-gutters {
    background: #f5f5f5 !important;
    color: black !important;
  }
  
  .crepe-editor-wrapper .cm-line {
    color: black !important;
  }
  
  /* è¡¨æ ¼ */
  .crepe-editor-wrapper table {
    border-collapse: collapse;
    page-break-inside: avoid;
  }
  
  .crepe-editor-wrapper th,
  .crepe-editor-wrapper td {
    border: 1px solid #333 !important;
    background: white !important;
    color: black !important;
  }
  
  .crepe-editor-wrapper th {
    background: #f0f0f0 !important;
  }
  
  /* å›¾ç‰‡ */
  .crepe-editor-wrapper img {
    max-width: 100% !important;
    page-break-inside: avoid;
  }
  
  /* åˆ†éš”çº¿ */
  .crepe-editor-wrapper hr {
    border-color: #333 !important;
  }
  
  /* ä»»åŠ¡åˆ—è¡¨å¤é€‰æ¡† */
  .crepe-editor-wrapper input[type="checkbox"] {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  /* LaTeX/æ•°å­¦å…¬å¼ */
  .crepe-editor-wrapper .katex,
  .crepe-editor-wrapper .katex-display {
    color: black !important;
  }
  
  /* éšè—é¢„è§ˆé¢æ¿ä¸­çš„ç¼–è¾‘å™¨ */
  .crepe-editor-wrapper .milkdown-code-block .preview-panel {
    background: #f9f9f9 !important;
    border: 1px solid #ddd !important;
  }
  
  .crepe-editor-wrapper .milkdown-code-block .preview-panel .preview {
    background: white !important;
    color: black !important;
  }
}

/* ===== æ‰‹åŠ¨æ‹–æ‹½æ’å…¥æ¡ï¼ˆæ¨¡ä»¿æ–‡ä»¶æ ‘å®ç°ï¼‰ ===== */
/* è¿™æ˜¯æˆ‘ä»¬æ‰‹åŠ¨å®ç°çš„ drop indicatorï¼Œå› ä¸º Crepe æ²¡æœ‰å†…ç½® dropcursor æ’ä»¶ */
.crepe-drop-indicator {
  position: absolute;
  left: 0;
  right: 0;
  height: 2px;
  pointer-events: none;
  z-index: 100;
  border-radius: 1px;
  transition: top 0.1s cubic-bezier(0.2, 0, 0, 1);
}

/* äº®è‰²æ¨¡å¼ï¼šè“è‰²æŒ‡ç¤ºæ¡ */
:root:not(.dark) .crepe-drop-indicator {
  background: hsl(var(--primary));
  box-shadow: 0 0 6px hsl(var(--primary) / 0.5);
}

:root:not(.dark) .crepe-drop-indicator::before {
  content: '';
  position: absolute;
  left: -2px;
  top: -3px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: hsl(var(--primary));
  border: 2px solid hsl(var(--background));
  box-shadow: 0 0 3px hsl(var(--primary) / 0.5);
}

/* æš—è‰²æ¨¡å¼ï¼šç™½è‰²æŒ‡ç¤ºæ¡ */
:root.dark .crepe-drop-indicator {
  background: #ffffff !important;
  box-shadow: 0 0 8px rgba(255, 255, 255, 0.6) !important;
}

.crepe-drop-indicator::before {
  content: '';
  position: absolute;
  left: -2px;
  top: -3px;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  border: 2px solid hsl(var(--background));
}

:root.dark .crepe-drop-indicator::before {
  background: #ffffff !important;
  box-shadow: 0 0 4px rgba(255, 255, 255, 0.6) !important;
}

/* ===== ProseMirror Drop Cursor (å¤‡ç”¨ï¼Œå¦‚æœ Crepe å°†æ¥æ”¯æŒ) ===== */
.ProseMirror-dropcursor {
  position: absolute;
  z-index: 100;
  pointer-events: none;
  height: 2px !important;
  width: 100% !important;
  left: 0 !important;
  right: 0 !important;
  border-radius: 1px;
}

:root:not(.dark) .ProseMirror-dropcursor {
  background: hsl(var(--primary)) !important;
  box-shadow: 0 0 4px hsl(var(--primary) / 0.5);
}

:root.dark .ProseMirror-dropcursor {
  background: #ffffff !important;
  box-shadow: 0 0 6px rgba(255, 255, 255, 0.6) !important;
}

/* Gap cursorï¼ˆç”¨äºç©ºç™½ä½ç½®ï¼‰ */
.crepe-editor-wrapper .ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
}

.crepe-editor-wrapper .ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 2px solid hsl(var(--primary));
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.crepe-editor-wrapper .ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}
