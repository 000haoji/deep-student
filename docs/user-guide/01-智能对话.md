# AI 智能对话

## 概述

AI 智能对话是 Deep Student 的核心功能模块，基于全新的 **Chat V2** 引擎构建。它不仅提供强大的 AI 对话能力，还通过 **Block（块）** 架构实现了更丰富的交互体验，如思维链折叠、多模态混排和工具调用可视化。

### 主要特性

- **Block 交互架构**：消息由独立的块组成，支持思维链折叠、代码块高亮、工具调用过程可视化
- **Skills 技能系统**：按需加载专业技能（如导师模式、ChatAnki），实现能力的渐进式披露
- **VFS 知识库检索**：深度集成虚拟文件系统，自动检索笔记、教材、题目集
- **上下文引用**：支持引用 VFS 中的任意资源作为对话上下文
- **推理模式**：支持深度思考模型（如 DeepSeek-R1），完整展示推理过程
- **自动任务完成**：Agent 模式下，AI 可自动判断任务是否完成并结束处理流程

---

## 快速开始

### 创建新会话

1. 点击侧边栏顶部的 **"+"** 按钮创建新会话
2. 或使用快捷键 `Cmd/Ctrl + N` 快速创建

### 发送消息

1. 在底部输入框输入问题
2. 按 **Enter** 发送（Shift + Enter 换行）
3. 等待 AI 回复

### 技能激活（推荐）

在开始对话前，根据你的需求激活特定技能效果更好：
- **学习新知识**：点击技能按钮，选择 `tutor-mode`（导师模式）
- **制作卡片**：点击技能按钮，选择 `chatanki`（制卡模式）
- **查阅资料**：点击技能按钮，选择 `knowledge-retrieval`（知识检索）

---

## 核心交互体验

### Block 消息流

Chat V2 的消息不再是简单的文本流，而是由多个功能块组成：

- **思维链块 (Thinking)**：对于支持推理的模型，AI 的思考过程会被折叠在一个独立的块中，点击可展开查看详细推理逻辑。
- **工具调用块**：当 AI 调用工具（如搜索、读取笔记）时，会显示一个动态的执行状态块，展示工具的输入、执行状态和结果。
- **内容块**：最终的文本回复。
- **Artifacts**：生成的代码、SVG 图表或长文本会以 Artifacts 形式呈现，支持独立预览和复制。

### 推理模式（思维链）

开启推理模式后，AI 会进行深度思考：

1. 点击输入栏底部工具栏中的 **推理模式按钮**（原子图标）
2. 开启后图标高亮，AI 回复时会先生成思维链块
3. 思维链内容默认折叠，保持界面整洁，点击即可展开

**适用场景**：复杂数学题解析、逻辑推理、代码架构设计。

### 上下文引用 (VFS集成)

Deep Student 的对话与你的知识库是打通的：

1. 打开右侧 **学习资源侧边栏**
2. 浏览或搜索你的笔记、教材、题目集
3. 点击资源卡片上的 **"引用"** 按钮
4. 资源会以标签形式添加到输入框上方
5. 发送消息时，AI 将能读取并参考这些资源的内容

---

## 技能系统与工具

Deep Student 采用 **Skills（技能）** 机制来管理 AI 的能力。

### 什么是技能？

技能是预配置的 AI 行为模式和工具包的组合。为了节省 Token 并提高 AI 专注度，工具不再全量加载，而是通过技能 **按需加载**。

### 常用技能

| 技能 ID | 名称 | 用途 | 包含工具 |
|---------|------|------|----------|
| `tutor-mode` | 导师模式 | 苏格拉底式教学，引导思考 | 无（纯指令） |
| `chatanki` | ChatAnki | 对话式制卡，支持多模态素材 | Anki 制卡工具 |
| `knowledge-retrieval` | 知识检索 | 查阅本地资料和网络信息 | RAG、网络搜索 |
| `canvas-note` | 笔记工具 | 在对话中创建和编辑笔记 | 笔记读写工具 |

### 激活方式

1. **UI 选择**：点击输入框下方的 **技能按钮**（闪电图标），选择所需技能。
2. **命令激活**：输入 `/skill [技能名]`（如 `/skill chatanki`）。
3. **自动推荐**：在对话中描述需求，AI 可能会建议你激活相关技能。

### MCP 工具支持

除了内置技能，你还可以通过 MCP (Model Context Protocol) 连接外部工具。MCP 工具也会作为技能的一部分出现在列表中。

---

## Agent 与 自动任务完成

在处理复杂任务（如"帮我调研这个课题并写一份报告"）时，AI 可能会连续执行多个步骤。

- **Attempt Completion**：Deep Student 内置了任务完成检测机制。当 AI 认为任务已经完成时，会调用 `attempt_completion` 工具，自动停止执行并总结结果。
- **人工干预**：在 Agent 执行过程中，你可以随时点击 **停止** 按钮中断流程。

---

## 消息操作

### 编辑与重试

- **编辑重发**：将鼠标悬停在你的消息上，点击 **编辑** 图标。修改后，AI 会基于新内容重新生成回复（会创建新的分支）。
- **重试**：对 AI 回复不满意？点击 **重试** 图标。支持切换模型进行重试。

### 多模型对比

不确定哪个模型效果好？

1. 点击输入栏底部的 **模型选择按钮**
2. 勾选多个模型（如 GPT-4o 和 Claude-3.5-Sonnet）
3. 发送消息
4. 系统会并行生成多个回复，并排展示，方便你对比选择最佳答案

---

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| **Enter** | 发送消息 |
| **Shift + Enter** | 换行 |
| **Cmd/Ctrl + K** | 打开命令面板 |
| **Cmd/Ctrl + Shift + T** | 切换推理模式 |
| **Cmd/Ctrl + Shift + S** | 打开技能选择面板 |

---

## 常见问题

### Q: 为什么我看不到"Anki 制卡"工具？
A: 工具现在通过技能按需加载。请先激活 **ChatAnki** 技能，制卡工具就会自动注入到当前对话中。

### Q: 为什么提示"请先配置对话模型"？
A: Chat V2 依赖"对话模型（Model2）"配置。请前往 **设置 -> 模型分配**，确保已为"对话模型"选择了可用的 AI 模型。

### Q: 思维链（Thinking）内容在哪里？
A: 对于支持思维链的模型（如 DeepSeek-R1），思维链内容被折叠在消息顶部的 "Thinking Process" 块中，点击即可展开阅读。

---

*最后更新：2026-02-10*