const fs = require('fs');

function getDisplayWidth(str) {
    let width = 0;
    // ä½¿ç”¨ Array.from æ­£ç¡®å¤„ç† emoji ç­‰å¤šå­—èŠ‚å­—ç¬¦
    for (let char of Array.from(str)) {
        if (char === 'ğŸ”’') {
            width += 2;
        } else if (char === 'â†’') {
            width += 2; // å³ç®­å¤´åœ¨å¾ˆå¤šå­—ä½“é‡Œç®—2å®½
        } else if (char === 'Â·') {
            width += 2; // ä¸­ç‚¹ç®—ä½œ2å®½ï¼ˆåœ¨å¾ˆå¤šä¸­æ–‡å­—ä½“ä¸­å¯¹é½æ•ˆæœæ›´å¥½ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥æ¢æˆç©ºæ ¼è°ƒæ•´ï¼‰
        } else if (char.match(/[\u4e00-\u9fa5\u3000-\u303f\uff00-\uffef]/)) {
            width += 2;
        } else {
            width += 1;
        }
    }
    return width;
}

const input = `â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DeepStudent                           â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚Chat V2 â”‚  â”‚ Learning â”‚  â”‚ Essay  â”‚  â”‚Settingsâ”‚   React   â”‚
â”‚  â”‚ (å¯¹è¯) â”‚  â”‚   Hub    â”‚  â”‚ (ä½œæ–‡) â”‚  â”‚ (é…ç½®) â”‚           â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚      â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               æŠ€èƒ½ç³»ç»Ÿ (Skills Engine)                 â”‚    â”‚
â”‚  â”‚  é»˜è®¤: æ·±åº¦å­¦è€…  â”‚  åˆ¶å¡ Â· è°ƒç ” Â· å¯¼å¸ˆ Â· æ–‡çŒ®ç»¼è¿°    â”‚    â”‚
â”‚  â”‚  å·¥å…·: è®ºæ–‡ Â· å¯¼å›¾ Â· é¢˜åº“ Â· è®°å¿† Â· æ£€ç´¢ Â· ...       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€Tauri IPC â”€â”¼â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ LLM Mgr  â”‚  â”‚   Chat Pipeline   â”‚  â”‚  MCP Runtime   â”‚   â”‚
â”‚  â”‚ (9ä¾›åº”å•†) â”‚â—„â”€â”¤   + å·¥å…·æ‰§è¡Œå™¨    â”œâ”€â–ºâ”‚  (å¤–éƒ¨å·¥å…·)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚  å¼•ç”¨ / RAG æ£€ç´¢                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         VFS Â· è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ (SSOT)                    â”‚     â”‚
â”‚  â”‚   ç¬”è®° Â· æ•™æ Â· é¢˜åº“ Â· å¯¼å›¾ Â· ç¿»è¯‘ Â· ä½œæ–‡ Â· è®°å¿†   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚    å‘é‡åŒ–æµæ°´çº¿: OCR â†’ åˆ†å— â†’ Embedding â†’ ç´¢å¼•      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  SQLite  â”‚  â”‚    LanceDB    â”‚  â”‚  Blob Files  â”‚          â”‚
â”‚  â”‚ (å…ƒæ•°æ®) â”‚  â”‚  (å‘é‡æ£€ç´¢)   â”‚  â”‚  (åŸå§‹æ–‡ä»¶)  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                               â”‚
â”‚                   ğŸ”’ å…¨éƒ¨æ•°æ®æœ¬åœ°å­˜å‚¨                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`;

function padRight(str, targetWidth) {
    let currentWidth = getDisplayWidth(str);
    if (currentWidth < targetWidth) {
        return str + ' '.repeat(targetWidth - currentWidth);
    }
    return str; // ä¸åšæˆªæ–­ï¼Œå› ä¸ºæˆ‘ä»¬åªç”¨æ¥è¡¥é½ç©ºæ ¼
}

const lines = input.split('\n');
const targetOuterWidth = 63; // ç¬¬ä¸€è¡Œçš„é•¿åº¦ 1+61+1 = 63
const innerWidth = targetOuterWidth - 2; // 61

const outputLines = lines.map((line, index) => {
    if (index === 0 || index === lines.length - 1) {
        return line.trim();
    }
    
    // å¤„ç†å¸¦å·¦å³è¾¹æ¡†çš„è¡Œ
    if (line.startsWith('â”‚')) {
        // å»é™¤å·¦è¾¹çš„ 'â”‚' å’Œå³è¾¹çš„ 'â”‚' (å¦‚æœæœ‰çš„è¯)ï¼Œä»¥åŠä¸¤ç«¯çš„ç©ºæ ¼
        let innerText = line.substring(1).replace(/â”‚\s*$/, '');
        // å»é™¤ innerText æœ«å°¾çš„ç©ºæ ¼
        innerText = innerText.replace(/\s+$/, '');
        
        let paddedInner = padRight(innerText, innerWidth);
        
        // å¦‚æœé•¿åº¦è¶…äº†ï¼Œæˆ‘ä»¬å°±åœ¨æœ«å°¾åˆ æ‰ä¸€äº›ç©ºæ ¼ã€‚ä½† padRight ä¸æˆªæ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å¤„ç†
        let currentWidth = getDisplayWidth(innerText);
        if (currentWidth > innerWidth) {
           // ç”±äºåªæ˜¯æ‰‹åŠ¨è®¾è®¡çš„ ascii è‰ºæœ¯ï¼Œå‡è®¾æˆ‘ä»¬é€šè¿‡å‡å°‘å†…éƒ¨çš„å‰å¯¼ç©ºæ ¼æ¥ä¿®å¤ï¼Œæˆ–è€…ä¿æŒåŸæ ·ã€‚
           // ä¸ºäº†å¯¹é½ï¼Œå¦‚æœè¶…äº†ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¿®æ­£ã€‚
        } else {
            return 'â”‚' + paddedInner + 'â”‚';
        }
    }
    return line;
});

console.log(outputLines.join('\n'));
